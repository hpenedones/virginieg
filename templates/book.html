{% extends "base.html" %}
{% block title %}{{ book.title }} | Virginie G.{% endblock %}
{% block content %}
<div class="book-page">
  <a href="{{ base }}livres/" class="back-link">← Livres</a>

  {% if book.featured %}
  <img src="{{ base }}{{ book.featured }}" alt="{{ book.title }}" class="book-featured">
  {% endif %}

  <div class="book-content">
    {{ book.html | safe }}
  </div>

  {% if book.cover or book.gallery %}
  <div class="book-gallery">
    {% if book.cover %}
    <img src="{{ base }}{{ book.cover }}" alt="Couverture — {{ book.title }}" onclick="openLightbox(this.src)">
    {% endif %}
    {% for img in book.gallery %}
    <img src="{{ base }}{{ img }}" alt="Intérieur — {{ book.title }}" onclick="openLightbox(this.src)">
    {% endfor %}
  </div>
  {% endif %}

  {% if book.reviews_html %}
  <div class="book-reviews">
    <h2>Avis de lecteurs</h2>
    {{ book.reviews_html | safe }}
  </div>
  {% endif %}

  {% if book.info_html %}
  <div class="book-info">
    {{ book.info_html | safe }}
  </div>
  {% endif %}

</div>

<div id="lightbox" onclick="this.style.display='none'">
  <img id="lightbox-img" src="" alt="">
</div>
<script>
function openLightbox(src) {
  document.getElementById('lightbox-img').src = src;
  document.getElementById('lightbox').style.display = 'flex';
}
document.addEventListener('keydown', function(e) {
  if (e.key === 'Escape') document.getElementById('lightbox').style.display = 'none';
});
</script>
{% endblock %}
